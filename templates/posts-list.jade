- var posts, topics, result;

- posts = _.chain(contents.posts._.directories).map(function(post) { return post['data.json'] }).sortBy(function(post) { return -moment(post.metadata.date, 'DD/MM/YYYY').unix() }).value();
- topics = _.reduce(posts, function(topics, post) {
-     return topics.concat(post.metadata.topics || []);
- }, []);

- if (_.size(topics) > 0) topics = _.uniq(topics);

- result = { topics: topics, posts: [] };
- result.posts = _.map(posts, function(post) {
-     var topicsIndex = [];
-     if (post.metadata.topics) topicsIndex = _.map(post.metadata.topics, function(topic) { return _.indexOf(topics, topic) });
-     return [ '/' + path.dirname(post.filename).replace(path.sep, '/'), topicsIndex ];
- });

!=JSON.stringify(result)