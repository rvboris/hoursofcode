define(["libs/keymaster","jquery","jquery.easing"],function(a){function d(a,d){this.element=a,this.options=$.extend({},c,d),this._defaults=c,this._name=b,this.init()}var b="ascensor",c={AscensorName:"ascensor",AscensorFloorName:"",ChildType:"div",WindowsOn:1,Direction:"y",AscensorMap:"",Time:"1000",Easing:"linear",KeyNavigation:!0,Queued:!1,QueuedDirection:"x",FloorChange:function(){},OnFloorChanged:function(){}};d.prototype.init=function(){function n(){if(h=$(window).width(),i=$(window).height(),$(e).width(h).height(i),$(c).width(h).height(i),"y"===l&&$(c).stop().scrollTop((f-1)*i),"x"===l&&($(c).stop().scrollLeft((f-1)*h),$(e).each(function(a){$(this).css("left",a*h)})),"chocolate"===l){var a=j[f-1].split("|");$(e).each(function(a){var b=j[a].split("|");$(this).css({left:(b[1]-1)*h,top:(b[0]-1)*i})}),$(c).stop().scrollLeft((a[1]-1)*h).scrollTop((a[0]-1)*i)}}function o(a,d){if("y"===l&&$(c).stop().animate({scrollTop:(a-1)*i},d,b.options.Easing),"x"===l&&$(c).stop().animate({scrollLeft:(a-1)*h},d,b.options.Easing,b.options.OnFloorChanged),"chocolate"===l){var e=j[a-1].split("|");b.options.Queued?"x"===b.options.QueuedDirection?$(c).scrollLeft()===(e[1]-1)*h?$(c).stop().animate({scrollTop:(e[0]-1)*i},d,b.options.Easing,b.options.OnFloorChanged):$(c).stop().animate({scrollLeft:(e[1]-1)*h},d,b.options.Easing,function(){$(c).stop().animate({scrollTop:(e[0]-1)*i},d,b.options.Easing,b.options.OnFloorChanged)}):"y"===b.options.QueuedDirection&&($(c).scrollTop()===(e[0]-1)*i?$(c).stop().animate({scrollLeft:(e[1]-1)*h},d,b.options.Easing,b.options.OnFloorChanged):$(c).stop().animate({scrollTop:(e[0]-1)*i},d,b.options.Easing,function(){$(c).stop().animate({scrollLeft:(e[1]-1)*h},d,b.options.Easing,b.options.OnFloorChanged)})):$(c).stop().animate({scrollLeft:(e[1]-1)*h,scrollTop:(e[0]-1)*i},d,b.options.Easing,b.options.OnFloorChanged)}$("."+b.options.AscensorName+"Link").removeClass(b.options.AscensorName+"LinkActive"),$("."+b.options.AscensorName+"Link"+a).addClass(b.options.AscensorName+"LinkActive"),f=a}function p(a,c){if(!$("input, textarea").is(":focus")&&("y"===l&&(1===a&&0===c&&(g>f+1||f+1===g)&&b.options.FloorChange(k[f]),-1===a&&0===c&&(f-1>1||1===f-1)&&b.options.FloorChange(k[f])),"x"===l&&(0===a&&-1===c&&(f-1>1||1===f-1)&&b.options.FloorChange(k[f]),0===a&&1===c&&(g>f+1||f+1===g)&&b.options.FloorChange(k[f])),"chocolate"===l)){var d=j[f-1].split("|");$.each(j,function(e){j[e]===parseInt(d[0],10)+a+"|"+(parseInt(d[1],10)+c)&&b.options.FloorChange(k[e])})}}var h,i,b=this,c=this.element,e=$(c).children(b.options.ChildType),f=b.options.WindowsOn,g=0,j=b.options.AscensorMap.split(" & "),k=b.options.AscensorFloorName.split(" | "),l=b.options.Direction;$(c).css("position","absolute").width(h).height(i),$(e).width(h).height(i).each(function(){g++,$(this).attr("id",b.options.AscensorName+"Floor"+g).addClass(b.options.AscensorName+"Floor")}),("x"===l||"chocolate"===l)&&$(e).css("position","absolute"),d.prototype.setFloorByHash=function(a){var c=$.inArray(a,k);0>c||(f=c+1,$("."+b.options.AscensorName+"Link").removeClass(b.options.AscensorName+"LinkActive").eq(f-1).addClass(b.options.AscensorName+"LinkActive"),o(f,b.options.Time))},$(window).resize(function(){n()}).load(function(){n()}).resize(),window.DeviceOrientationEvent&&$(window).bind("orientationchange",function(){n()}),a("up, down, right, left",function(a,b){switch(b.shortcut){case"up":p(-1,0);break;case"down":p(1,0);break;case"right":p(0,1);break;case"left":p(0,-1)}}),$("."+b.options.AscensorName+"Link").on("click",function(){var a=$(this).attr("class");a=a.split(/\s+/),a=a[1],a=a.split(b.options.AscensorName+"Link"),a=parseInt(a[1],10),b.options.FloorChange(k[a-1])}),$("."+b.options.AscensorName+"LinkPrev").on("click",function(){f-=1,1>f&&(f=g),b.options.FloorChange(k[f])}),$("."+b.options.AscensorName+"LinkNext").on("click",function(){f+=1,f>g&&(f=1),b.options.FloorChange(k[f])})},$.fn[b]=function(a){return this.each(function(){$.data(this,b)||$.data(this,b,new d(this,a))})}});