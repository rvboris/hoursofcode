define([],function(){return function(a){function j(a,b){for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function l(a){for(b in d)d[b]=a[k[b]]}function m(a,b){var e,g,h,k,m;if(e=a.keyCode,-1==j(i,e)&&i.push(e),(93==e||224==e)&&(e=91),e in d){d[e]=!0;for(h in f)f[h]==e&&(p[h]=!0)}else if(l(a),p.filter.call(this,a)&&e in c)for(k=0;c[e].length>k;k++)if(g=c[e][k],g.scope==b||"all"==g.scope){m=g.mods.length>0;for(h in d)(!d[h]&&j(g.mods,+h)>-1||d[h]&&-1==j(g.mods,+h))&&(m=!1);(0!=g.mods.length||d[16]||d[18]||d[17]||d[91])&&!m||g.method(a,g)===!1&&(a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation&&a.stopPropagation(),a.cancelBubble&&(a.cancelBubble=!0))}}function n(a){var c,b=a.keyCode,e=j(i,b);if(e>=0&&i.splice(e,1),(93==b||224==b)&&(b=91),b in d){d[b]=!1;for(c in f)f[c]==b&&(p[c]=!1)}}function o(){for(b in d)d[b]=!1;for(b in f)p[b]=!1}function p(a,b,d){var e,g,i,j;for(void 0===d&&(d=b,b="all"),a=a.replace(/\s/g,""),e=a.split(","),""==e[e.length-1]&&(e[e.length-2]+=","),i=0;e.length>i;i++){if(g=[],a=e[i].split("+"),a.length>1){for(g=a.slice(0,a.length-1),j=0;g.length>j;j++)g[j]=f[g[j]];a=[a[a.length-1]]}a=a[0],a=h(a),a in c||(c[a]=[]),c[a].push({shortcut:e[i],scope:b,method:d,key:e[i],mods:g})}}function q(a){return"string"==typeof a&&(a=h(a)),-1!=j(i,a)}function r(){return i.slice(0)}function s(a){var b=(a.target||a.srcElement).tagName;return!("INPUT"==b||"SELECT"==b||"TEXTAREA"==b)}function t(a){e=a||"all"}function u(){return e||"all"}function v(a){var b,d,e;for(b in c)for(d=c[b],e=0;d.length>e;)d[e].scope===a?d.splice(e,1):e++}function w(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,function(){c(window.event)})}function y(){var b=a.key;return a.key=x,b}var b,c={},d={16:!1,18:!1,17:!1,91:!1},e="all",f={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},g={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},h=function(a){return g[a]||a.toUpperCase().charCodeAt(0)},i=[];for(b=1;20>b;b++)f["f"+b]=111+b;var k={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(b in f)p[b]=!1;w(document,"keydown",function(a){m(a,e)}),w(document,"keyup",n),w(window,"focus",o);var x=a.key;a.key=p,a.key.setScope=t,a.key.getScope=u,a.key.deleteScope=v,a.key.filter=s,a.key.isPressed=q,a.key.getPressedKeyCodes=r,a.key.noConflict=y,"undefined"!=typeof module&&(module.exports=key)}(this),this.key});